SELECT ls.en, count(lds_v.variable_id) FROM variable v LEFT JOIN logicaldataset_variable lds_v ON lds_v.variable_id=v.id LEFT JOIN study_logicaldataset s_lds ON s_lds.logicalDataSet_id=lds_v.logicalDataSet_id LEFT JOIN logicaldataset lds ON lds.id=s_lds.logicalDataSet_id LEFT JOIN study s ON s.id=s_lds.study_id LEFT JOIN langstring ls ON ls.id=s.title_id WHERE lds.isPublic=true GROUP BY s_lds.study_id